<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Crawlers</title>
        <script type="text/javascript" src="../../../resources/libs/p5.js"></script>
    </head>

    <body></body>

    <script>
        var crawlers = [];

        function setup() {
            var ctx = createCanvas(innerWidth, innerHeight);
            for (i = 0; i < 100; i++) {
                crawlers[i] = new crawler();
                crawlers[i].setup();
            }
            strokeWeight(2);
        }

        function draw() {
            for (i = 0; i < crawlers.length; i++) {
                crawlers[i].update();
                crawlers[i].display();
            }
        }

        function crawler() {
            this.x;
            this.y;
            this.last_x;
            this.last_y;
            this.speed_x;
            this.speed_y;
            this.step_amount;
            this.step = 0;
            this.color;

            this.setup = function() {
                this.x = width / 2;
                this.y = height / 2;
                this.last_x = width / 2;
                this.last_y = height / 2;
                this.speed_x = random(-4, 4);
                this.speed_y = random(-4, 4);
                this.step_amount = random(40);
                if (crawlers.length <= 4) {
                    this.color = [255, 0, 0];
                } else {
                    rand = random(255);
                    this.color = [rand, rand, rand];
                }
            }

            this.update = function() {
                this.step++;
                if (this.step >= this.step_amount) {
                    this.step_amount += random(40);
                    this.speed_x = random(-4, 4);
                    this.speed_y = random(-4, 4);
                }
                this.last_x = this.x;
                this.last_y = this.y;
                this.x += this.speed_x;
                this.y += this.speed_y;
            }

            this.display = function() {
                stroke(this.color[0], this.color[1], this.color[2]);
                line(this.last_x, this.last_y, this.x, this.y);
            }
        }
    </script>
</html>